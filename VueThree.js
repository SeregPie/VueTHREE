(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b(require("three")):"function"==typeof define&&define.amd?define(["three"],b):a.VueThree=b(a.THREE)})(this,function(a){"use strict";function b(a){return{created:function(){var b=this;a.forEach(function(a){b.$watch(a)})}}}function c(a){return a&&"object"==typeof a}function d(a,b){return Array.isArray(b)?a.fromArray(b):c(b)&&Object.assign(a,b),a}function e(a){return"number"==typeof a}function f(a,b){return Array.isArray(b)?a.fromArray(b):c(b)?Object.assign(a,b):e(b)&&a.setScalar(b),a}function g(a){var b=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return a.call.apply(a,[this,b].concat(c))};return b}function h(a,b){g(function(c){requestAnimationFrame(function(){!1!==a()&&setTimeout(c,b)})})()}var i={color:{type:[Number,String],default:0},far:{type:Number,default:1e3},near:{type:Number,default:1}},j={name:"VueThreeFog",mixins:[b([function(){this.fog.color.set(this.color)},function(){this.fog.near=this.near},function(){this.fog.far=this.far}])],props:i,computed:{fog:function(){return new a.Fog}},created:function(){this.$parent.object.fog=this.fog},beforeDestroy:function(){this.$parent.object.fog=null},render:function(a){return a("div")}},k={name:{type:String,default:""},position:{type:[Array,Object],default:function(){return[0,0,0]}},quaternion:{type:[Array,Object],default:function(){return[0,0,0,1]}},scale:{type:[Number,Array,Object],default:1},userData:{default:function(){return{}}}},l={name:"VueThreeObject",mixins:[b([function(){f(this.object.position,this.position)},function(){d(this.object.quaternion,this.quaternion)},function(){f(this.object.scale,this.scale)},function(){this.object.name=this.name},function(){this.object.userData=this.userData}])],props:k,computed:{object:function(){return new a.Object3D},renderer:function(){return this.$parent.renderer}},watch:{object:{handler:function(a,b){b&&(this.$parent.object.remove(b),this.dispose(b)),a&&this.$parent.object.add(a)},immediate:!0}},beforeDestroy:function(){this.$parent.object.remove(this.object),this.dispose(this.object)},methods:{dispose:function(){}},render:function(a){return a("div",this.$slots.default)}},m={far:{type:Number,default:2e3},fov:{type:Number,default:50},near:{type:Number,default:1/10}},n={name:"VueThreePerspectiveCamera",mixins:[l,b([function(){this.object.fov=this.fov},function(){this.object.near=this.near},function(){this.object.far=this.far}])],props:m,computed:{object:function(){return new a.PerspectiveCamera}},created:function(){this.$parent.$parent.camera=this.object},beforeDestroy:function(){this.$parent.$parent.camera=null}},o={color:{type:[Number,String],default:16777215},decay:{type:Number,default:1},distance:{type:Number,default:0},intensity:{type:Number,default:1}},p={name:"VueThreePointLight",mixins:[l,b([function(){this.object.color.set(this.color)},function(){this.object.intensity=this.intensity},function(){this.object.distance=this.distance},function(){this.object.decay=this.decay}])],props:o,computed:{object:function(){return new a.PointLight}}},q={alpha:{type:Boolean,default:!1},antialias:{type:Boolean,default:!0},clearAlpha:{type:Number,default:1},clearColor:{type:[Number,String],default:0},preserveDrawingBuffer:{type:Boolean,default:!1}},r={name:"VueThreeRenderer",mixins:[function(a){return{data:function b(){var c=this,d=c.$options,b={},e=d.computed;return Object.entries(a).forEach(function(a){var c=a[0],d=a[1];b["$_frozenData_"+c]={},e[c]={get:function(){return this["$_frozenData_"+c],d},set:function(a){d=a,this["$_frozenData_"+c]={}}}}),b},computed:{}}}(function(){return{camera:null,scene:null}}),b([function(){var a=this,b=a.renderer,c=a.camera,d=a.elementWidth,e=a.elementHeight;b.setSize(d,e),0<d&&0<e&&c&&(c.aspect=d/e,c.updateProjectionMatrix())},function(){this.renderer.setClearColor(this.clearColor,this.clearAlpha)}])],props:q,data:function(){return{elementHeight:0,elementWidth:0}},computed:{renderer:function(){var b=this,c=b.alpha,d=b.antialias,e=b.preserveDrawingBuffer;return new a.WebGLRenderer({alpha:c,antialias:d,preserveDrawingBuffer:e})}},mounted:function(){var a=this;this.$refs.canvasContainer.appendChild(this.renderer.domElement),h(function(){return!a._isDestroyed&&void(a.updateElementSize(),a.renderScene())},1e3)},methods:{renderScene:function(){var a=this,b=a.camera,c=a.renderer,d=a.scene;c&&d&&b&&c.render(d,b)},updateElementSize:function(){var a=this,b=a.$el;b&&(this.elementWidth=b.offsetWidth,this.elementHeight=b.offsetHeight)}},render:function(a){return a("div",{style:{height:"100%",overflow:"hidden",position:"relative",width:"100%"}},[a("div",{ref:"canvasContainer",style:{bottom:0,left:0,position:"absolute",right:0,top:0}},this.$slots.default)])}},s={Fog:j,Object:l,PerspectiveCamera:n,PointLight:p,Renderer:r,Scene:{name:"VueThreeScene",computed:{object:function(){return new a.Scene},renderer:function(){return this.$parent.renderer}},created:function(){this.$parent.scene=this.object},beforeDestroy:function(){this.$parent.scene=null},render:function(a){return a("div",this.$slots.default)}}},t=Object.assign({},{install:function(a){Object.values(this.components).forEach(function(b){a.component(b.name,b)})},components:s},s);return"undefined"!=typeof window&&window.Vue&&window.Vue.use(t),t});
