(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b(require("three")):"function"==typeof define&&define.amd?define(["three"],b):a.VueThree=b(a.THREE)})(this,function(a){"use strict";function b(a){return{created:function(){var b=this;a.forEach(function(a){b.$watch(a)})}}}function c(a){return a&&"object"==typeof a}function d(a,b){return Array.isArray(b)?a.fromArray(b):c(b)&&Object.assign(a,b),a}function e(a){return"number"==typeof a}function f(a,b){return Array.isArray(b)?a.fromArray(b):c(b)?Object.assign(a,b):e(b)&&a.setScalar(b),a}var g={color:{type:[Number,String],default:0},near:{type:Number,default:1},far:{type:Number,default:1e3}},h={name:"VueThreeFog",mixins:[b([function(){this.fog.color.set(this.color)},function(){this.fog.near=this.near},function(){this.fog.far=this.far}])],props:g,computed:{fog:function(){return new a.Fog}},created:function(){this.$parent.object.fog=this.fog},beforeDestroy:function(){this.$parent.object.fog=null},render:function(a){return a("div")}},i={position:{type:[Array,Object],default:function(){return[0,0,0]}},quaternion:{type:[Array,Object],default:function(){return[0,0,0,1]}},scale:{type:[Number,Array,Object],default:1},name:{type:String,default:""},userData:{default:function(){return{}}}},j={name:"VueThreeObject",mixins:[b([function(){f(this.object.position,this.position)},function(){d(this.object.quaternion,this.quaternion)},function(){f(this.object.scale,this.scale)},function(){this.object.name=this.name},function(){this.object.userData=this.userData}])],props:i,computed:{object:function(){return new a.Object3D},renderer:function(){return this.$parent.renderer}},watch:{object:{handler:function(a,b){b&&(this.$parent.object.remove(b),this.dispose(b)),a&&this.$parent.object.add(a)},immediate:!0}},beforeDestroy:function(){this.$parent.object.remove(this.object),this.dispose(this.object)},methods:{dispose:function(){}},render:function(a){return a("div",this.$slots.default)}},k={fov:{type:Number,default:50},near:{type:Number,default:1/10},far:{type:Number,default:2e3}},l={name:"VueThreePerspectiveCamera",mixins:[j,b([function(){this.object.fov=this.fov},function(){this.object.near=this.near},function(){this.object.far=this.far}])],props:k,computed:{object:function(){return new a.PerspectiveCamera}},created:function(){this.$parent.$parent.camera=this.object},beforeDestroy:function(){this.$parent.$parent.camera=null}},m={color:{type:[Number,String],default:16777215},intensity:{type:Number,default:1},distance:{type:Number,default:0},decay:{type:Number,default:1}},n={name:"VueThreePointLight",mixins:[j,b([function(){this.object.color.set(this.color)},function(){this.object.intensity=this.intensity},function(){this.object.distance=this.distance},function(){this.object.decay=this.decay}])],props:m,computed:{object:function(){return new a.PointLight}}},o={antialias:{type:Boolean,default:!0},alpha:{type:Boolean,default:!1},clearColor:{type:[Number,String],default:0},clearAlpha:{type:Number,default:1},preserveDrawingBuffer:{type:Boolean,default:!1}},p={name:"VueThreeRenderer",mixins:[function(a){return{data:function b(){var b={},c={};return Object.entries(a).forEach(function(a){var d=a[0],e=a[1];b["frozenData_"+d]={},c[d]={get:function(){return this["frozenData_"+d],e},set:function(a){e=a,this["frozenData_"+d]={}}}}),Object.assign(this.$options.computed,c),b}}}(function(){return{scene:null,camera:null}}),b([function(){var a=this,b=a.renderer,c=a.camera,d=a.elementWidth,e=a.elementHeight;b.setSize(d,e),0<d&&0<e&&c&&(c.aspect=d/e,c.updateProjectionMatrix())},function(){this.renderer.setClearColor(this.clearColor,this.clearAlpha)}])],props:o,data:function(){return{elementWidth:0,elementHeight:0}},computed:{renderer:function(){var b=this,c=b.alpha,d=b.antialias,e=b.preserveDrawingBuffer;return new a.WebGLRenderer({alpha:c,antialias:d,preserveDrawingBuffer:e})}},mounted:function(){this.$refs.canvasContainer.appendChild(this.renderer.domElement),this.startElementResizeDetector(),this.startSceneRenderer()},methods:{detectElementResize:function(){this.elementWidth=this.$el.offsetWidth,this.elementHeight=this.$el.offsetHeight},renderScene:function(){var a=this,b=a.renderer,c=a.scene,d=a.camera;b&&c&&d&&b.render(c,d)},startElementResizeDetector:function(){var a=this;requestAnimationFrame(function(){a._isDestroyed||(setTimeout(function(){a.startElementResizeDetector()},1e3),a.detectElementResize())})},startSceneRenderer:function(){var a=this;requestAnimationFrame(function(){a._isDestroyed||(setTimeout(function(){a.startSceneRenderer()},1e3),a.renderScene())})}},render:function(a){var b=a("div",{style:{position:"absolute",top:0,right:0,bottom:0,left:0},ref:"canvasContainer"},this.$slots.default),c=a("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden"}},[b]);return c}},q=Object.freeze({Fog:h,Object:j,PerspectiveCamera:l,PointLight:n,Renderer:p,Scene:{name:"VueThreeScene",computed:{object:function(){return new a.Scene},renderer:function(){return this.$parent.renderer}},created:function(){this.$parent.scene=this.object},beforeDestroy:function(){this.$parent.scene=null},render:function(a){return a("div",this.$slots.default)}}}),r=Object.assign({},{install:function(a){Object.values(this.components).forEach(function(b){a.component(b.name,b)})},components:q},q);return"undefined"!=typeof window&&window.Vue&&window.Vue.use(r),r});
